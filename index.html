<!DOCTYPE HTML>
<html>
	<head>
		<title>Scala Editor</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
	</head>
	<body class="is-preload">
		<link rel="stylesheet" href="theme/yeti.css">
		<link rel="stylesheet" href="lib/codemirror.css">
		<script src="assets/js/jquery.min.js"></script>
		<script src="assets/js/browser.min.js"></script>
		<script src="assets/js/breakpoints.min.js"></script>
		<script src="assets/js/util.js"></script>
		<script src="assets/js/main.js"></script>
		<script src="theme/yeti.css"></script>
		<script src="lib/codemirror.js"></script>
		<script src="mode/clike/clike.js"></script>
		<script src="addon/edit/matchbrackets.js"></script>
		<script src="addon/edit/closebrackets.js"></script>
		<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.18.0/axios.min.js"></script>
		<!-- Wrapper -->
			<div id="wrapper">

				<!-- Header -->
				<header id="header">
						<h1><a href="index.html">Scala Editor</a></h1>
						<nav class="links">
						   <ul>
							  <li class="dropdown">
								 <a href="javascript:void(0)" class="dropbtn">Dropdown</a>
								 <div class="dropdown-content">
									<a href="#">Link 1></a>
									<a href="#">Link 2></a>
									<a href="#">Link 3></a>
								 </div>
							  <li>
						   </ul>
						</nav>
						<nav class="main">
						   <ul>
							  <li class="menu">
								 <a class="fa-bars" href="#menu">Menu</a>
							  </li>
						   </ul>
						</nav>
					 </header>
	  
					<section id="menu">

							<section>
								<form class="search" method="get" action="#">
									<input type="text" name="query" placeholder="Search" />
								</form>
							</section>

							<section>
								<ul class="links">
									<li>
										<a href="#">
											<h3>Lorem ipsum</h3>
											<p>Feugiat tempus veroeros dolor</p>
										</a>
									</li>
									<li>
										<a href="#">
											<h3>Dolor sit amet</h3>
											<p>Sed vitae justo condimentum</p>
										</a>
									</li>
									<li>
										<a href="#">
											<h3>Feugiat veroeros</h3>
											<p>Phasellus sed ultricies mi congue</p>
										</a>
									</li>
									<li>
										<a href="#">
											<h3>Etiam sed consequat</h3>
											<p>Porta lectus amet ultricies</p>
										</a>
									</li>
								</ul>
							</section>

							<section>
								<ul class="actions stacked">
									<li><a href="#" class="button large fit">Log In</a></li>
								</ul>
							</section>

					</section>

					<div id="main">
						<form name = "code_form"><textarea id="code_text"></textarea></form>
							<button type="button" onclick="save_to_server();">Save</button>
							<button type="button" onclick="btn_js_prompt_click();">Compile</button>
							<form name = "result_form" style="margin-top: 3em;"><textarea id="result_text" name ="result_text"></textarea></form>
							  <script>
								var editor = CodeMirror.fromTextArea(document.getElementById("code_text"), {
									lineNumbers: true,
									matchBrackets: true,
									autoCloseBrackets: true,
        							theme: "yeti",
        							mode: "text/x-scala"
								});
								function btn_js_prompt_click(){
										var codestring = editor.getValue();
										var class_name = prompt("Please Write your Class Name", "");
										if(class_name) {
											alert("Saved as "+ class_name);
											code_to_server(codestring, class_name);
										}
      	  							else alert("Canceled");
      								}
								function code_to_server(codestring, class_name) {
									var codeJSON = {"classname" : class_name, "code" : codestring};
									var codestring = JSON.stringify(codeJSON);
									console.log(codestring); 
									var xhr = new XMLHttpRequest();
									xhr.open("POST", 'http://52.231.65.108:8080/api/run', true);
									xhr.setRequestHeader('Access-Control-Allow-Origin', '*');
									xhr.setRequestHeader("Access-Control-Allow-Credentials", "true");
									xhr.setRequestHeader("Content-Type", "application/json");
									xhr.send(codestring);
								}
							  </script>
			</div>


	</body>
</html>